machine:
  node:
    version: 8.0.0

dependencies:
  pre:
    - mkdir -p ~/.go_project/src/github.com/Cistern
    - ln -s ~/$CIRCLE_PROJECT_REPONAME ~/.go_project/src/github.com/Cistern

compile:
  override:
    - go build ./cmd/cistern && mv cistern $CIRCLE_ARTIFACTS
    - cd ui && npm i && npm run build && tar czvf static.tar.gz static && mv static.tar.gz $CIRCLE_ARTIFACTS

test:
  override:
    - go test $(go list ./... | grep -v /vendor/)
